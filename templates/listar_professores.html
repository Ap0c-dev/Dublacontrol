{% extends "base.html" %}

{% block title %}Listar Professores - Controle de Dublagem{% endblock %}
{% block page_title %}Lista de Professores{% endblock %}

{% block extra_css %}
    .professores-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        background: white;
    }
    
    .professores-table th,
    .professores-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid #ddd;
    }
    
    .professores-table th {
        background: #667eea;
        color: white;
        font-weight: bold;
    }
    
    .professores-table tr:hover {
        background: #f8f9fa;
    }
    
    .badge {
        display: inline-block;
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 0.85em;
        font-weight: bold;
        margin-right: 5px;
    }
    
    .badge-success {
        background: #28a745;
        color: white;
    }
    
    .badge-info {
        background: #17a2b8;
        color: white;
    }
    
    .btn-criar-usuario {
        display: inline-block;
        padding: 8px 15px;
        background: #17a2b8;
        color: white;
        text-decoration: none;
        border-radius: 5px;
        font-size: 0.9em;
        font-weight: bold;
        transition: all 0.3s;
        border: none;
        cursor: pointer;
        white-space: nowrap;
    }
    
    .btn-criar-usuario:hover {
        background: #138496;
        transform: translateY(-1px);
        box-shadow: 0 2px 5px rgba(0,0,0,0.2);
    }
    
    .empty-state {
        text-align: center;
        padding: 40px;
        color: #6c757d;
    }
    
    .empty-state p {
        font-size: 1.2em;
        margin-top: 10px;
    }
    
    /* Responsividade */
    @media (max-width: 768px) {
        .professores-table {
            font-size: 0.85em;
            display: block;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }
        
        .professores-table thead {
            display: none;
        }
        
        .professores-table tbody,
        .professores-table tr {
            display: block;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            padding: 10px;
            background: white;
        }
        
        .professores-table td {
            display: block;
            text-align: left;
            padding: 8px;
            border: none;
            border-bottom: 1px solid #eee;
        }
        
        .professores-table td:last-child {
            border-bottom: none;
        }
        
        .professores-table td::before {
            content: attr(data-label) ": ";
            font-weight: bold;
            color: #667eea;
            display: inline-block;
            min-width: 100px;
        }
        
        .badge {
            display: inline-block;
            margin: 2px;
            font-size: 0.75em;
        }
        
        .btn-criar-usuario {
            width: 100%;
            text-align: center;
            margin-top: 5px;
        }
    }
    
    @media (max-width: 480px) {
        .professores-table {
            font-size: 0.75em;
        }
        
        .professores-table td {
            padding: 6px;
        }
        
        .professores-table td::before {
            min-width: 80px;
            font-size: 0.9em;
        }
    }
{% endblock %}

{% block content %}
{% if professores %}
    <table class="professores-table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Telefone</th>
                <th>Dia da Semana</th>
                <th>Horário</th>
                <th>Modalidades</th>
                <th>Usuário</th>
                <th>Data de Cadastro</th>
                {% if current_user.is_admin() %}
                <th>Ações</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for professor in professores %}
            <tr>
                <td data-label="ID">{{ professor.id }}</td>
                <td data-label="Nome"><strong>{{ professor.nome|format_name }}</strong></td>
                <td data-label="Telefone">{{ professor.telefone or '-' }}</td>
                <td data-label="Dia da Semana">
                    {% if professor.horarios %}
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            {% for horario in professor.horarios %}
                                <div style="font-size: 0.9em; min-height: 1.5em;">
                                    {{ horario.dia_semana }}
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <span style="color: #6c757d;">-</span>
                    {% endif %}
                </td>
                <td data-label="Horário">
                    {% if professor.horarios %}
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            {% for horario in professor.horarios %}
                                <div style="font-size: 0.9em; min-height: 1.5em;">
                                    <strong>{{ horario.horario_aula }}</strong>
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        <span style="color: #6c757d;">-</span>
                    {% endif %}
                </td>
                <td data-label="Modalidades">
                    {% if professor.horarios %}
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            {% for horario in professor.horarios %}
                                <div style="min-height: 1.5em; display: flex; align-items: center;">
                                    {% if horario.modalidade %}
                                        {% if horario.modalidade == 'dublagem_presencial' %}
                                            <span class="badge badge-success">Dublagem Presencial</span>
                                        {% elif horario.modalidade == 'dublagem_online' %}
                                            <span class="badge badge-success">Dublagem Online</span>
                                        {% elif horario.modalidade == 'teatro_presencial' %}
                                            <span class="badge badge-info">Teatro Presencial</span>
                                        {% elif horario.modalidade == 'teatro_online' %}
                                            <span class="badge badge-info">Teatro Online</span>
                                        {% elif horario.modalidade == 'musical' %}
                                            <span class="badge" style="background: #ffc107; color: #333;">Musical</span>
                                        {% elif horario.modalidade == 'locucao' %}
                                            <span class="badge" style="background: #dc3545; color: white;">Locução</span>
                                        {% elif horario.modalidade == 'teatro_tv_cinema' %}
                                            <span class="badge badge-info">Teatro TV e Cinema</span>
                                        {% elif horario.modalidade == 'curso_apresentador' %}
                                            <span class="badge" style="background: #6c757d; color: white;">Curso de Apresentador</span>
                                        {% else %}
                                            <span class="badge" style="background: #6c757d; color: white;">{{ horario.modalidade|replace('_', ' ')|title }}</span>
                                        {% endif %}
                                    {% else %}
                                        <span style="color: #6c757d;">-</span>
                                    {% endif %}
                                </div>
                            {% endfor %}
                        </div>
                    {% else %}
                        {% if professor.dublagem_presencial %}
                            <span class="badge badge-success">Dublagem Presencial</span>
                        {% endif %}
                        {% if professor.dublagem_online %}
                            <span class="badge badge-success">Dublagem Online</span>
                        {% endif %}
                        {% if professor.teatro_presencial %}
                            <span class="badge badge-info">Teatro Presencial</span>
                        {% endif %}
                        {% if professor.musical %}
                            <span class="badge" style="background: #ffc107; color: #333;">Musical</span>
                        {% endif %}
                        {% if professor.locucao %}
                            <span class="badge" style="background: #dc3545; color: white;">Locução</span>
                        {% endif %}
                        {% if professor.curso_apresentador %}
                            <span class="badge" style="background: #6c757d; color: white;">Curso de Apresentador</span>
                        {% endif %}
                        {% if not professor.dublagem_presencial and not professor.dublagem_online and not professor.teatro_presencial and not professor.musical and not professor.locucao and not professor.curso_apresentador %}
                            <span>-</span>
                        {% endif %}
                    {% endif %}
                </td>
                <td data-label="Usuário">
                    {% if professores_com_usuario[professor.id] %}
                    <span style="color: #28a745; font-weight: bold;">✓ Tem usuário</span>
                    {% else %}
                    <span style="color: #dc3545;">✗ Sem usuário</span>
                    {% endif %}
                </td>
                <td data-label="Data Cadastro">{{ professor.data_cadastro.strftime('%d/%m/%Y %H:%M') if professor.data_cadastro else '-' }}</td>
                {% if current_user.is_admin() %}
                <td data-label="Ações">
                    <div style="display: flex; gap: 5px; flex-wrap: wrap;">
                        <a href="{{ url_for('main.editar_professor', professor_id=professor.id) }}" 
                           style="display: inline-block; padding: 6px 12px; background: #667eea; color: white; text-decoration: none; border-radius: 5px; font-size: 0.9em; font-weight: bold; transition: all 0.3s;"
                           onmouseover="this.style.background='#5568d3'"
                           onmouseout="this.style.background='#667eea'">
                            Editar
                        </a>
                        {% if not professores_com_usuario[professor.id] %}
                        <a href="{{ url_for('main.cadastro_usuario_professor') }}?professor_id={{ professor.id }}" 
                           class="btn-criar-usuario">
                            Criar Usuário
                        </a>
                        {% endif %}
                    </div>
                </td>
                {% endif %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% else %}
    <div class="empty-state">
        <h2>Nenhum professor cadastrado ainda</h2>
        <p>Comece cadastrando professores na página de cadastro.</p>
    </div>
{% endif %}
{% endblock %}

